<%- include('./partials/header') %> 
<%- include('./partials/navbar') %> 

<div class="compose-log-div">

    <div class="event-compose-container">
        <h2 class="event-compose-title"><%=event.name%></h2>
        <img src="<%=event.image%>" alt="Planet" class="event-compose-image">
        <p>Location: <%=event.location%></p>
        <p>Description: <%=event.description%></p>
        <p>Equipment: <%=event.equipment%></p>
         <p>Health: <%=event.health%></p>
    </div>

    <div class="text-compose-container">

        <form action="/jump/<%=galaxy.name%>/logs/<%=event.name%>" method="POST">

            <div class="hidden-inputs">
            <input type="text" name="author" value=<%=login.username%> >
            
            </div>

            <label for="title">Log title</label>
            <input type="text" id="title" name="title" placeholder="Title">

            <label for="body">Log entry</label>
            <textarea name="body" id="body" cols="25" rows="15" placeholder="Describe the events of the day..."></textarea>

            <button type='submit' class="text-compose-button">Submit log</button>
        </form>

        <div class="text-compose-synonyms-search-div">
            <form class="synonyms-search-form">
            <label>
                <span>Need a synonym?</span>
                <input type="text" name="synonym" class="text-compose-form-input"/>
            </label>
            
            </form>
            <p class="synonyms-display-paragraph"> </p>
        </div>

    </div>
</div>

<script>
    let synonymsForm = document.querySelector('.synonyms-search-form')
    let synonymsDisplay = document.querySelector('.synonyms-display-paragraph')
    let formInput = document.querySelector('.text-compose-form-input')
    
    let word 

    synonymsForm.addEventListener('submit', (e) => {
        e.preventDefault()
        word = formInput.value
        synonymsForm.reset()
        getSynonyms()
    })

    let url = 'https://api.dictionaryapi.dev/api/v2/entries/en/'
    let synonymsArray = []

    const getSynonyms = async() => {
        try {
        synonymsArray = []
        const res = await fetch(url + word)
        const data = await res.json()

        data[0].meanings.forEach(meaning => {
                if (meaning.synonyms.length > 0) {
                    meaning.synonyms.forEach(synonym => {
                        synonymsArray.push(synonym)
                    })
                }
            })
        synonymsDisplay.innerText = synonymsArray
    } catch (err) {
        console.log(err.message)
    }
} 
</script>

<%- include('./partials/footer') %> 