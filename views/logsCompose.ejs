<%- include('./partials/header') %> 
<%- include('./partials/navbar') %> 

<div class="compose-log-div">

    <div class="event-compose-container">
        <h2 class="event-compose-title"><%=event.name%></h2>
        
        <div class="swiper mySwiper">
            <!-- Additional required wrapper -->
            <div class="swiper-wrapper">
              <!-- Slides -->
              <div class="swiper-slide"><img src="<%=event.image[0]%>"  class="event-compose-image"></div>
              <div class="swiper-slide"><img src="<%=event.image[1]%>"  class="event-compose-image"></div>
              <div class="swiper-slide"><img src="<%=event.image[2]%>"  class="event-compose-image"></div>
    
            </div>
            <!-- If we need navigation buttons -->
            <div class="swiper-button-prev"></div>
            <div class="swiper-button-next"></div>
            <div class="swiper-pagination"></div>
          </div>

        <p>Description: <%=event.description%></p>

    </div>

    <div class="text-compose-container">

        <form action="/jump/<%=galaxy.name%>/logs/<%=event.name%>" method="POST">

            <div class="hidden-inputs">
            <input type="text" name="author" value=<%=login.username%> >
            
            </div>

            <label for="title">Log title</label>
            <input type="text" id="title" name="title" placeholder="Title">

            <label for="body">Log entry</label>
            <textarea name="body" id="body" cols="25" rows="15" placeholder="Describe the events of the day..."
            autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>

            <button type='submit' class="text-compose-button">Submit log</button>
        </form>

        <div class="text-compose-synonyms-search-div">
            <form class="synonyms-search-form">
            <label>
                <span>Need a synonym?</span>
                <input type="text" name="synonym" class="text-compose-form-input"/>
            </label>
            
            </form>
            <p class="synonyms-display-paragraph"> </p>
        </div>

    </div>
</div>

<script>
    var swiper = new Swiper('.mySwiper', {
    
    loop: true,

    pagination: {
          el: ".swiper-pagination",
          clickable: true,
        },
    // Navigation arrows
    navigation: {
    nextEl: '.swiper-button-next',
    prevEl: '.swiper-button-prev',
}})

    let synonymsForm = document.querySelector('.synonyms-search-form')
    let synonymsDisplay = document.querySelector('.synonyms-display-paragraph')
    let formInput = document.querySelector('.text-compose-form-input')
    
    let word 

    synonymsForm.addEventListener('submit', (e) => {
        e.preventDefault()
        word = formInput.value
        synonymsForm.reset()
        getSynonyms()
    })

    let url = 'https://api.dictionaryapi.dev/api/v2/entries/en/'
    let synonymsArray = []

    const getSynonyms = async() => {
        try {
        synonymsArray = []
        const res = await fetch(url + word)
        const data = await res.json()

        data[0].meanings.forEach(meaning => {
                if (meaning.synonyms.length > 0) {
                    meaning.synonyms.forEach(synonym => {
                        synonymsArray.push(synonym)
                    })
                }
            })
        synonymsDisplay.innerText = synonymsArray
    } catch (err) {
        console.log(err.message)
    }
} 
</script>

<%- include('./partials/footer') %> 